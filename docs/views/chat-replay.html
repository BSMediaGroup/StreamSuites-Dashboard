<!-- ========================================================= -->
<!-- StreamSuites — Unified Chat Replay (Preview) -->
<!-- Read-only, informational preview surface -->
<!-- ========================================================= -->

<style>
  .ss-controls-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 16px;
    align-items: start;
  }

  .ss-mode-toggle {
    display: inline-flex;
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 10px;
    overflow: hidden;
  }

  .ss-mode-button {
    padding: 10px 14px;
    background: transparent;
    color: #e7ecff;
    border: none;
    cursor: pointer;
    font-weight: 700;
    letter-spacing: 0.04em;
    text-transform: uppercase;
    transition: background 0.2s ease, color 0.2s ease;
    font-family: "SuiGenerisRg", system-ui, -apple-system, "Segoe UI", sans-serif;
  }

  .ss-mode-button.active {
    background: linear-gradient(135deg, rgba(83, 83, 255, 0.25), rgba(190, 132, 255, 0.2));
    color: #ffffff;
  }

  .ss-mode-button:not(:last-child) {
    border-right: 1px solid rgba(255, 255, 255, 0.08);
  }

  /* Theme selector — Na3ar-17 inspired */
  .theme-card {
    width: 100%;
    max-width: 340px;
    background-color: rgba(36, 40, 50, 1);
    background-image: linear-gradient(
      139deg,
      rgba(36, 40, 50, 1) 0%,
      rgba(36, 40, 50, 1) 0%,
      rgba(37, 28, 40, 1) 100%
    );
    border-radius: 12px;
    padding: 16px 0;
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: 0 18px 32px rgba(0, 0, 0, 0.35);
    border: 1px solid rgba(255, 255, 255, 0.06);
  }

  .theme-card .separator {
    border-top: 1.5px solid #42434a;
  }

  .theme-card .list {
    list-style-type: none;
    display: flex;
    flex-direction: column;
    gap: 8px;
    padding: 0 14px;
    margin: 0;
  }

  .theme-card .element {
    display: flex;
    align-items: center;
    color: #bfc5d4;
    gap: 10px;
    transition: all 0.2s ease-out;
    padding: 6px 9px;
    border-radius: 8px;
    cursor: pointer;
    border: 1px solid transparent;
  }

  .theme-card .element svg {
    width: 19px;
    height: 19px;
    transition: all 0.3s ease-out;
  }

  .theme-card .label {
    font-weight: 700;
    letter-spacing: 0.03em;
  }

  .theme-card .element:hover,
  .theme-card .element.active {
    background-color: #5353ff;
    color: #ffffff;
    transform: translate(1px, -1px);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .theme-card .element:hover svg,
  .theme-card .element.active svg {
    stroke: #ffffff;
  }

  .theme-card .element:active {
    transform: scale(0.99);
  }

  .theme-card .list:last-child svg {
    stroke: #bd89ff;
  }
  .theme-card .list:last-child .element {
    color: #bd89ff;
  }

  .theme-card .list:last-child .element:hover,
  .theme-card .list:last-child .element.active {
    background-color: rgba(56, 45, 71, 0.9);
    color: #ffffff;
  }

  .ss-chat-input {
    padding: 12px 0;
  }

  .ss-chat-input-shell {
    position: relative;
    background: #05060e;
    border: 1px solid rgba(255, 255, 255, 0.14);
    border-radius: 14px;
    padding: 14px;
    padding-bottom: 70px;
    min-height: 140px;
  }

  .ss-chat-textarea-wrap {
    overflow-y: auto;
  }

  .ss-chat-textarea {
    width: 100%;
    min-height: 96px;
    resize: none;
    background: transparent;
    border: none;
    color: #f5f7ff;
    padding: 12px;
    border-radius: 10px;
    font-size: 1rem;
    font-family: "SuiGenerisRg", system-ui, -apple-system, "Segoe UI", sans-serif;
    letter-spacing: 0.02em;
    line-height: 1.4;
  }

  .ss-chat-textarea::placeholder { color: rgba(255, 255, 255, 0.55); }
  .ss-chat-textarea:focus { outline: none; }

  .ss-chat-actions {
    position: absolute;
    left: 16px;
    right: 16px;
    bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }

  .ss-chat-actions-left {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .ss-icon-btn {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    background: rgba(255, 255, 255, 0.06);
    color: rgba(255, 255, 255, 0.7);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .ss-icon-btn svg { width: 18px; height: 18px; }

  .ss-send-btn {
    width: 46px;
    height: 46px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.16);
    background: rgba(86, 138, 255, 0.18);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .ss-send-btn img {
    width: 22px;
    height: 22px;
    display: block;
    filter: invert(43%) sepia(79%) saturate(1454%) hue-rotate(201deg) brightness(98%) contrast(99%);
  }

  .ss-mock-chat {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    padding: 12px;
    display: grid;
    gap: 10px;
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.32);
  }

  .ss-mock-row {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: 10px;
    align-items: start;
  }

  .ss-mock-row .avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.14);
    background: #0c1020;
    align-self: flex-start;
  }

  .ss-mock-row .avatar img { width: 100%; height: 100%; object-fit: cover; display: block; }

  .ss-mock-row .platform-stack {
    display: inline-flex;
    gap: 6px;
    align-items: center;
    justify-content: flex-end;
  }

  .ss-mock-row .platform-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 4px 8px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
    font-size: 0.78rem;
  }

  .ss-mock-row .platform-badge img { width: 16px; height: 16px; display: block; }

  .ss-mock-row .meta {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .ss-mock-row .meta .name {
    display: inline-flex;
    gap: 6px;
    align-items: center;
    font-weight: 700;
    letter-spacing: 0.03em;
  }

  .ss-mock-row .meta .badges {
    display: inline-flex;
    gap: 6px;
    align-items: center;
    flex-wrap: wrap;
  }

  .ss-mock-row .badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 18px;
    height: 18px;
  }

  .ss-mock-row .badge img { width: 18px; height: 18px; }

  .ss-mock-row .text { color: #dbe2ff; font-size: 0.92rem; line-height: 1.4; }

  .ss-iframe-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 18px;
    align-items: start;
  }

  .ss-iframe-card {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    padding: 14px;
    box-shadow: 0 12px 28px rgba(0, 0, 0, 0.28);
  }

  .ss-iframe-frame {
    background: #0d1220;
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 10px;
    overflow: hidden;
  }

  .ss-popout-btn {
    background: linear-gradient(120deg, rgba(94, 115, 255, 0.32), rgba(158, 112, 255, 0.3));
    border: 1px solid rgba(255, 255, 255, 0.18);
    color: #f2f5ff;
    padding: 10px 14px;
    border-radius: 10px;
    font-weight: 700;
    letter-spacing: 0.03em;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    box-shadow: 0 10px 24px rgba(0, 0, 0, 0.32);
  }
</style>

<!-- ========================================================= -->
<!-- HEADER -->
<!-- ========================================================= -->
<header class="ss-header">
  <div class="ss-header-left">
    <h1 class="ss-title">Unified Chat Replay (Preview)</h1>
    <span class="ss-subtitle">Pop-out + OBS previews (scaffolded)</span>
  </div>
  <div class="ss-header-right">
    <span class="ss-badge ss-badge-warning">Scaffolded — Not Live</span>
  </div>
</header>

<!-- ========================================================= -->
<!-- MAIN -->
<!-- ========================================================= -->
<main class="ss-main">

  <section class="ss-panel">
    <header class="ss-panel-header">
      <h2>Preview-only surface</h2>
    </header>

    <div class="ss-panel-body">
      <p>
        The Unified Chat Replay experience is scaffolded for visibility only. These previews
        load local placeholder HTML and do not hydrate from runtime feeds yet.
      </p>
      <p class="muted" style="margin-bottom: 0;">
        There is no resizing logic, no persistence, and no outbound connections. The dashboard
        remains static and read-only.
      </p>
    </div>
  </section>

  <section class="ss-panel">
    <header class="ss-panel-header" style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;">
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
        <h2 style="margin:0;">Modes &amp; Controls</h2>
        <div class="ss-mode-toggle" role="group" aria-label="Replay or Live">
          <button class="ss-mode-button active" data-mode="replay" type="button">Replay</button>
          <button class="ss-mode-button" data-mode="live" type="button">Live</button>
        </div>
      </div>
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
        <button class="ss-popout-btn" id="popout-chat-button" type="button">
          <img src="./assets/icons/ui/send.svg" alt="Pop-out" width="18" height="18" />
          Pop-out Chat Window
        </button>
        <button class="ss-popout-btn" id="popout-overlay-button" type="button">
          <img src="./assets/icons/ui/send.svg" alt="Pop-out" width="18" height="18" />
          Pop-out OBS Overlay
        </button>
      </div>
    </header>

    <div class="ss-panel-body">
      <div class="ss-controls-grid">
        <div>
          <p style="margin-top:0;">Theme selector follows the Na3ar-17 card structure so runtime parity can be eyeballed.</p>
          <div class="theme-card" id="theme-card" aria-label="Theme selector">
            <ul class="list">
              <li class="element active" data-theme="default">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon-star">
                  <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                  <path d="M19 3v4"></path>
                  <path d="M21 5h-4"></path>
                </svg>
                <p class="label">Default</p>
              </li>
              <li class="element" data-theme="slate">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-cloudy">
                  <path d="M17.5 19a4.5 4.5 0 0 0-.3-9 6 6 0 0 0-11-2"></path>
                  <path d="M12.5 19H5a3 3 0 0 1-.1-6"></path>
                </svg>
                <p class="label">Slate</p>
              </li>
            </ul>
            <div class="separator"></div>
            <ul class="list">
              <li class="element" data-theme="midnight">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles">
                  <path d="M12 3v4"></path>
                  <path d="M10 5h4"></path>
                  <path d="m5 19 1.5-3L10 14.5 6.5 13 5 10l-1.5 3L0 14.5 3.5 16 5 19Z"></path>
                  <path d="M15 19h7"></path>
                  <path d="M18.5 16.5v5"></path>
                </svg>
                <p class="label">Midnight</p>
              </li>
              <li class="element" data-theme="light">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24" fill="none" stroke="#7e8590" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun">
                  <circle cx="12" cy="12" r="5"></circle>
                  <path d="M12 1v2"></path>
                  <path d="M12 21v2"></path>
                  <path d="m4.22 4.22 1.42 1.42"></path>
                  <path d="m18.36 18.36 1.42 1.42"></path>
                  <path d="M1 12h2"></path>
                  <path d="M21 12h2"></path>
                  <path d="m4.22 19.78 1.42-1.42"></path>
                  <path d="m18.36 5.64 1.42-1.42"></path>
                </svg>
                <p class="label">Light</p>
              </li>
            </ul>
          </div>
        </div>

        <div>
          <p style="margin-top:0;">Live input preview mirrors the Lakshay-art treatment with our dark palette.</p>
          <div class="ss-chat-input" aria-label="Live input preview">
            <div class="ss-chat-input-shell">
              <div class="ss-chat-textarea-wrap">
                <textarea
                  rows="3"
                  class="ss-chat-textarea"
                  placeholder="Ask me anything..."
                ></textarea>
              </div>
              <div class="ss-chat-actions">
                <div class="ss-chat-actions-left">
                  <button class="ss-icon-btn" type="button" aria-label="Attach file">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                    </svg>
                  </button>
                  <button class="ss-icon-btn" type="button" aria-label="Attach web link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <circle r="10" cy="12" cx="12"></circle>
                      <path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"></path>
                      <path d="M2 12h20"></path>
                    </svg>
                  </button>
                  <button class="ss-icon-btn" type="button" aria-label="Attach Figma link">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                      <path d="M5 5.5A3.5 3.5 0 0 1 8.5 2H12v7H8.5A3.5 3.5 0 0 1 5 5.5z"></path>
                      <path d="M12 2h3.5a3.5 3.5 0 1 1 0 7H12V2z"></path>
                      <path d="M12 12.5a3.5 3.5 0 1 1 7 0 3.5 3.5 0 1 1-7 0z"></path>
                      <path d="M5 19.5A3.5 3.5 0 0 1 8.5 16H12v3.5a3.5 3.5 0 1 1-7 0z"></path>
                      <path d="M5 12.5A3.5 3.5 0 0 1 8.5 9H12v7H8.5A3.5 3.5 0 0 1 5 12.5z"></path>
                    </svg>
                  </button>
                </div>
                <button class="ss-send-btn" type="button" aria-label="Send">
                  <img src="../assets/icons/ui/send.svg" alt="Send" />
                </button>
              </div>
            </div>
          </div>

          <div class="ss-mock-chat" aria-label="Badge alignment preview">
            <div class="ss-mock-row">
              <div class="avatar" aria-hidden="true">
                <img src="./assets/placeholders/daniel.png" alt="" />
              </div>
              <div class="meta">
                <div class="name">daniel_clancy</div>
                <div class="badges">
                  <span class="badge" title="Owner"><img src="./assets/icons/dcbadge.svg" alt="Owner" /></span>
                  <span class="badge" title="Pro User"><img src="./assets/icons/prouser.svg" alt="Pro" /></span>
                  <span class="badge" title="Moderator"><img src="./assets/icons/mod.svg" alt="Moderator" /></span>
                </div>
                <div class="text">Multi-badge example shows stack ordering with reduced text size and tighter line-height.</div>
              </div>
              <div class="platform-stack">
                <span class="platform-badge" aria-label="YouTube"><img src="./assets/icons/youtube.svg" alt="YouTube" />YouTube</span>
                <span class="platform-badge" aria-label="Discord"><img src="./assets/icons/discord.svg" alt="Discord" />Discord</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="ss-panel">
    <header class="ss-panel-header">
      <h2 style="margin:0;">Preview Targets</h2>
      <p class="muted" style="margin:6px 0 0 0;">Avatar visibility, platform badges (top-right), and reduced message text size mirror the runtime mocks.</p>
    </header>

    <div class="ss-panel-body">
      <div class="ss-iframe-grid">
        <div class="ss-iframe-card">
          <div class="ss-panel-header" style="padding:0 0 10px 0;margin:0 0 10px 0;border-bottom:1px solid rgba(255,255,255,0.06);">
            <div style="display:flex;align-items:center;gap:10px;">
              <div style="font-weight:600;letter-spacing:0.02em;">Embedded Chat Window</div>
              <span class="ss-badge" style="background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.12);color:#dfe6ff;">Preview</span>
            </div>
            <p class="muted" style="margin:6px 0 0 0;">Embeddable window for local chat playback mock.</p>
          </div>
          <div class="ss-iframe-frame">
            <iframe
              id="window-preview"
              src="../views/chat_replay_window.html?mode=replay&theme=default"
              title="Embedded Chat Window Preview"
              style="width:100%;height:360px;border:0;filter:saturate(1);background:#0d1220;"
              loading="lazy"
            ></iframe>
          </div>
        </div>

        <div class="ss-iframe-card">
          <div class="ss-panel-header" style="padding:0 0 10px 0;margin:0 0 10px 0;border-bottom:1px solid rgba(255,255,255,0.06);">
            <div style="display:flex;align-items:center;gap:10px;">
              <div style="font-weight:600;letter-spacing:0.02em;">OBS / Browser Source Overlay</div>
              <span class="ss-badge" style="background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.12);color:#dfe6ff;">Preview</span>
            </div>
            <p class="muted" style="margin:6px 0 0 0;">Documentation-grade overlay scaffold for OBS/browser sources.</p>
          </div>
          <div class="ss-iframe-frame">
            <iframe
              id="overlay-preview"
              src="../views/chat_overlay_obs.html?theme=default&mode=replay"
              title="OBS / Browser Source Overlay Preview"
              style="width:100%;height:360px;border:0;filter:saturate(1);background:#0d1220;"
              loading="lazy"
            ></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>

</main>

<!-- ========================================================= -->
<!-- FOOTER -->
<!-- ========================================================= -->
<footer class="ss-footer">
  <span class="muted">
    Unified Chat Replay previews are scaffolded only; runtime hydration will be added later.
  </span>
</footer>

<script>
  (() => {
    const themeCard = document.getElementById('theme-card');
    const modeButtons = Array.from(document.querySelectorAll('.ss-mode-button'));
    const chatButton = document.getElementById('popout-chat-button');
    const overlayButton = document.getElementById('popout-overlay-button');
    const windowFrame = document.getElementById('window-preview');
    const overlayFrame = document.getElementById('overlay-preview');
    const basePath = window.location.pathname.includes('/views/') ? '../' : './';

    const state = {
      theme: themeCard?.querySelector('.element.active')?.dataset.theme || 'default',
      mode: modeButtons.find((btn) => btn.classList.contains('active'))?.dataset.mode || 'replay'
    };

    const setModeButtonState = () => {
      modeButtons.forEach((button) => button.classList.toggle('active', button.dataset.mode === state.mode));
    };

    const setThemeState = (nextTheme) => {
      if (!nextTheme) return;
      state.theme = nextTheme;
      themeCard?.querySelectorAll('.element').forEach((el) => {
        el.classList.toggle('active', el.dataset.theme === state.theme);
      });
    };

    const windowSrc = () =>
      state.mode === 'live'
        ? `${basePath}views/chat_window.html?mode=live&theme=${state.theme}`
        : `${basePath}views/chat_replay_window.html?mode=replay&theme=${state.theme}`;

    const overlaySrc = () => `${basePath}views/chat_overlay_obs.html?theme=${state.theme}&mode=${state.mode}`;

    const reloadFrames = () => {
      if (windowFrame) {
        windowFrame.src = windowSrc();
      }
      if (overlayFrame) {
        overlayFrame.src = overlaySrc();
      }
    };

    themeCard?.addEventListener('click', (event) => {
      const element = event.target.closest('.element');
      if (!element || !themeCard.contains(element)) return;
      const nextTheme = element.dataset.theme;
      setThemeState(nextTheme);
      reloadFrames();
    });

    modeButtons.forEach((button) => {
      button.addEventListener('click', () => {
        const nextMode = button.dataset.mode;
        if (!nextMode) return;
        state.mode = nextMode;
        setModeButtonState();
        reloadFrames();
      });
    });

    chatButton?.addEventListener('click', () => {
      const target = windowFrame?.src || windowSrc();
      window.open(target, '_blank', 'noopener');
    });

    overlayButton?.addEventListener('click', () => {
      window.open(overlaySrc(), '_blank', 'noopener');
    });

    setModeButtonState();
    reloadFrames();
  })();

</script>
