<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StreamSuites | Chat Replay</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
  />
  <link rel="stylesheet" href="static/chat.css" />
  <link rel="stylesheet" href="static/themes/theme-default.css" />
  <link rel="stylesheet" href="static/themes/theme-slate.css" />
  <link rel="stylesheet" href="static/themes/theme-midnight.css" />
</head>
<body class="chat-shell" data-asset-base="assets/">
  <script>
    window.chatAssetBase = (document.body.dataset.assetBase || "assets/").replace(/\/?$/, "/");
  </script>
  <section class="chat-window">
    <header class="chat-header">
      <div>
        <h1>Chat Replay (Preview)</h1>
        <div class="subtext">Static mock data â€¢ No live ingestion yet</div>
      </div>
      <div class="chat-controls">
        <button class="chat-btn" id="toggle-timestamps">Timestamps: On</button>
        <button class="chat-btn" id="toggle-autoscroll">Autoscroll: On</button>
      </div>
      <div class="theme-selector" aria-label="Theme selector">
        <button class="theme-btn is-active" data-theme-target="default">Default</button>
        <button class="theme-btn" data-theme-target="slate">Slate</button>
        <button class="theme-btn" data-theme-target="midnight">Midnight</button>
      </div>
    </header>

    <main class="chat-log" id="chat-log" aria-label="Chat messages"></main>

    <footer class="chat-footer">
      <div class="chat-footer-controls">
        <button class="chat-btn" id="pause-feed">Pause</button>
        <button class="chat-btn" id="clear-feed">Clear</button>
      </div>
      <button class="chat-toggle" id="status-indicator"><span></span> Replay Ready (Mock)</button>
    </footer>
  </section>

  <script src="../static/chat_mock_data.js"></script>
  <script>
    const chatLog = document.getElementById('chat-log');
    let timestampsVisible = true;
    let autoscrollEnabled = true;
    let paused = false;

    const themeButtons = document.querySelectorAll('.theme-btn');

    function applyTheme(theme) {
      if (!theme || theme === 'default') {
        document.documentElement.removeAttribute('data-theme');
      } else {
        document.documentElement.setAttribute('data-theme', theme);
      }
    }

    function applyToggles() {
      document.querySelectorAll('.timestamp').forEach((el) => {
        el.style.display = timestampsVisible ? 'inline-flex' : 'none';
      });
    }

    function appendMessages(entries) {
      if (paused) return;
      renderChatLog(chatLog, entries);
      applyToggles();
      if (autoscrollEnabled) {
        chatLog.scrollTop = chatLog.scrollHeight;
      }
    }

    document.getElementById('toggle-timestamps').addEventListener('click', () => {
      timestampsVisible = !timestampsVisible;
      document.getElementById('toggle-timestamps').textContent = `Timestamps: ${timestampsVisible ? 'On' : 'Off'}`;
      applyToggles();
    });

    document.getElementById('toggle-autoscroll').addEventListener('click', () => {
      autoscrollEnabled = !autoscrollEnabled;
      document.getElementById('toggle-autoscroll').textContent = `Autoscroll: ${autoscrollEnabled ? 'On' : 'Off'}`;
      if (autoscrollEnabled) {
        chatLog.scrollTop = chatLog.scrollHeight;
      }
    });

    document.getElementById('pause-feed').addEventListener('click', () => {
      paused = !paused;
      document.getElementById('pause-feed').textContent = paused ? 'Resume' : 'Pause';
    });

    document.getElementById('clear-feed').addEventListener('click', () => {
      chatLog.innerHTML = '';
    });

    themeButtons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const theme = btn.dataset.themeTarget;
        applyTheme(theme);
        themeButtons.forEach((b) => b.classList.toggle('is-active', b === btn));
      });
    });

    appendMessages(chatMessages);
  </script>
</body>
</html>
